/*!
 * Start Bootstrap - Agency v3.3.7+1 (http://startbootstrap.com/template-overviews/agency)
 * Copyright 2013-2016 Start Bootstrap
 * Licensed under MIT (https://github.com/BlackrockDigital/startbootstrap/blob/gh-pages/LICENSE)
 */
!function(t){"use strict";t("a.page-scroll").bind("click",function(a){var o=t(this);t("html, body").stop().animate({scrollTop:t(o.attr("href")).offset().top-50},1250,"easeInOutExpo"),a.preventDefault()}),t("body").scrollspy({target:".navbar-fixed-top",offset:51}),t(".navbar-collapse ul li a").click(function(){t(".navbar-toggle:visible").click()}),t("#mainNav").affix({offset:{top:100}})}(jQuery);

// window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('login', {
//   'size': 'invisible',
//   'callback': function(response) {
//     // reCAPTCHA solved, allow signInWithPhoneNumber.
//     onSignInSubmit();
//   }
// });

// var phoneNumber = getPhoneNumberFromUserInput();
// var appVerifier = window.recaptchaVerifier;
// firebase.auth().signInWithPhoneNumber(phoneNumber, appVerifier)
//     .then(function (confirmationResult) {
//       // SMS sent. Prompt user to type the code from the message, then sign the
//       // user in with confirmationResult.confirm(code).
//       window.confirmationResult = confirmationResult;
//     }).catch(function (error) {
//       // Error; SMS not sent
//       // ...
//     });

// var code = getCodeFromUserInput();
// confirmationResult.confirm(code).then(function (result) {
//   // User signed in successfully.
//   var user = result.user;
//   // ...
// }).catch(function (error) {
//   // User couldn't sign in (bad verification code?)
//   // ...
// });

// var credential = firebase.auth.PhoneAuthProvider.credential(confirmationResult.verificationId, code);

// firebase.auth().signInWithCredential(credential);

// THIS SENDS LOGIN DATA TO FIREBASE BUT I NEED TO USE AUTHENTICATION
// var config = {
//     apiKey: "AIzaSyAdgycqP7HbVBRs29kRL5pRFHHzZ9_CHTw",
//     authDomain: "beer-me-863c9.firebaseapp.com",
//     databaseURL: "https://beer-me-863c9.firebaseio.com",
//     projectId: "beer-me-863c9",
//     storageBucket: "beer-me-863c9.appspot.com",
//     messagingSenderId: "71623818381"
//   };
//     firebase.initializeApp(config);
//     // Create a variable to reference the database.
//     var database = firebase.database();

//     var signIn = {};
//     // Initial Values
   
//    $(document).on("click", "#login", function(event) {
//     console.log("test");

//             event.preventDefault();

//             signIn.name = $("#name").val().trim();
//             signIn.number = $("#phone-number").val().trim();

//             database.ref().push(signIn);

//             $("#name").val("");
//             $("#phone-number").val("");
//       });


var config = {
    apiKey: "AIzaSyAdgycqP7HbVBRs29kRL5pRFHHzZ9_CHTw",
    authDomain: "beer-me-863c9.firebaseapp.com",
    databaseURL: "https://beer-me-863c9.firebaseio.com",
    projectId: "beer-me-863c9",
    storageBucket: "beer-me-863c9.appspot.com",
    messagingSenderId: "71623818381"
  };
    firebase.initializeApp(config);
    // Create a variable to reference the database.
    var database = firebase.database();

    var reviewData = {};
    // Initial Values
   
   $(document).on("click", "#add-brewery-btn", function(event) {
    console.log("test");

            event.preventDefault();

            reviewData.name = $("#brewery-name-input").val().trim();
            reviewData.comment = $("#comments-input").val().trim();
            
            database.ref().push(reviewData);
      });

database.ref().on("child_added", function(childSnapshot) {
      // Log everything that's coming out of snapshot
      console.log(childSnapshot.val().name);
      console.log(childSnapshot.val().comment);

      // full list of items to the well
      $("#brewery-data").append("<p>" + childSnapshot.val().name + "</p>");
      // $(".data-data").append("<p>" + moment(reviewData).format("hh:mm A") + "</p>");
      $("#comments-data").append("<p>" + childSnapshot.val().comment + "</p>");
      
      // empty form after submit
      $("#brewery-name-input").val("");
      $("#comments-input").val("");

    // Handle the errors
    }, function(errorObject) {
      console.log("Errors handled: " + errorObject.code);
    });

// calling BEER MAPPING PROJECT API to get addresses of breweries
var queryURL = "http://beermapping.com/webservice/loccity/1e07e953394846ca559ab1d498fb5b41/" + "denver,co" + "&s=json";

      $.ajax({
          url: queryURL,
          method: "GET"
        })
        .done(function(response) {
          console.log(response);

          for (var i = 0; i < response.length; i++) {
            var currentBrewery = response[i];
            var address = {
              street: currentBrewery.street,
              city: currentBrewery.city,
              state: currentBrewery.state,
              zip: currentBrewery.zip,
                }
            var status = currentBrewery.status;

            if (status === "Brewery") {     
              // $("#breweries").append(response[i].name)
              // $("#breweries").append(JSON.stringify(address));
            }       
          }
        });